<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Practice | Dream Centre</title>
    <link rel="stylesheet" href="css/main.css">
    <script src="/auth.js" defer></script>
</head>

<body class="dashboard-page">
    <header class="test-header practice-header">
        <div class="logo">Typing <span>Practice Zone</span></div>
        <a href="/dashboard.html" class="nav-button secondary">Exit Practice</a>
    </header>

    <main class="container">
        <!-- CONFIG VIEW -->
        <div id="config-view" class="practice-config">
            <h2 class="config-title">Configure Your Session</h2>

            <div class="config-group">
                <label>Test Duration</label>
                <div class="selector-grid">
                    <button class="select-btn" onclick="setTime(60, this)">1 Minute</button>
                    <button class="select-btn active" onclick="setTime(120, this)">2 Minutes</button>
                    <button class="select-btn" onclick="setTime(300, this)">5 Minutes</button>
                </div>
            </div>

            <div class="config-group">
                <label>Passage Difficulty</label>
                <div class="selector-grid">
                    <button class="select-btn active" onclick="setDiff('easy', this)">Easy</button>
                    <button class="select-btn" onclick="setDiff('medium', this)">Medium</button>
                    <button class="select-btn" onclick="setDiff('hard', this)">Hard</button>
                </div>
            </div>

            <div class="sim-toggle">
                <input type="checkbox" id="true-sim-check" />
                <div>
                    <label for="true-sim-check">True Simulation Mode</label>
                    <small>Minimal UI, monospaced font, large textarea ‚Äî emulates a real exam</small>
                </div>
            </div>

            <button class="primary start-btn" onclick="launchPractice()">Launch Practice Session</button>

            <hr class="practice-divider">

            <!-- Finger Drill Section -->
            <h3 class="drill-section-title">Finger Drill Practice</h3>
            <div class="drill-picker">
                <div class="drill-picker-grid">
                    <button class="drill-pick-btn" onclick="selectDrill('home', this)">
                        <span class="pick-icon">üè†</span> Home Row
                    </button>
                    <button class="drill-pick-btn" onclick="selectDrill('top', this)">
                        <span class="pick-icon">‚¨ÜÔ∏è</span> Top Row
                    </button>
                    <button class="drill-pick-btn" onclick="selectDrill('bottom', this)">
                        <span class="pick-icon">‚¨áÔ∏è</span> Bottom Row
                    </button>
                    <button class="drill-pick-btn" onclick="selectDrill('numbers', this)">
                        <span class="pick-icon">üî¢</span> Numbers
                    </button>
                    <button class="drill-pick-btn" onclick="selectDrill('words', this)">
                        <span class="pick-icon">üìù</span> Common Words
                    </button>
                    <button class="drill-pick-btn" onclick="selectDrill('custom', this)">
                        <span class="pick-icon">‚úèÔ∏è</span> Custom
                    </button>
                </div>
                <div id="word-set-picker" class="word-set-picker">
                    <button class="word-set-btn active" onclick="selectWordSet('1k', this)">1K Words</button>
                    <button class="word-set-btn" onclick="selectWordSet('5k', this)">5K Words</button>
                    <button class="word-set-btn" onclick="selectWordSet('10k', this)">10K Words</button>
                </div>
                <textarea id="drill-custom-text" class="drill-custom-input" rows="2"
                    placeholder="Type your custom drill text here..."></textarea>
                <button class="primary start-btn drill-start-btn" onclick="launchDrill()">Start Finger Drill</button>
            </div>
        </div>

        <!-- DECORATED ENGINE (sim-style layout WITH visual feedback) -->
        <div id="decorated-engine" class="dec-engine hidden">
            <div class="sim-stats">
                <span>Time: <strong id="dec-timer">02:00</strong></span>
                <span>WPM: <strong id="dec-wpm">0</strong></span>
                <span>Accuracy: <strong id="dec-accuracy">100%</strong></span>
            </div>
            <div id="dec-passage" class="sim-passage">Loading passage...</div>
            <textarea id="dec-input" class="sim-textarea" placeholder="Start typing here..." autocomplete="off"
                autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>

            <div id="dec-admin-bypass" class="admin-bypass">
                <button id="dec-quick-submit">Admin: Quick Submit</button>
            </div>
        </div>

        <!-- TRUE SIMULATION ENGINE -->
        <div id="sim-engine" class="sim-engine hidden">
            <div class="sim-stats">
                <span>Time: <strong id="sim-timer">02:00</strong></span>
                <span>WPM: <strong id="sim-wpm">0</strong></span>
                <span>Accuracy: <strong id="sim-accuracy">100%</strong></span>
            </div>
            <div class="text-size-controls">
                <span>Text Size</span>
                <button class="text-size-btn" onclick="changePassageSize(-1)">‚àí</button>
                <button class="text-size-btn" onclick="changePassageSize(1)">+</button>
            </div>
            <div id="sim-passage" class="sim-passage">Loading passage...</div>
            <textarea id="sim-input" class="sim-textarea" placeholder="Start typing here..." autocomplete="off"
                autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>

            <div id="sim-admin-bypass" class="admin-bypass">
                <button id="sim-quick-submit">Admin: Quick Submit</button>
            </div>
        </div>

        <!-- DRILL ENGINE -->
        <div id="drill-engine" class="drill-engine hidden">
            <div class="drill-header">
                <h3 id="drill-title">Finger Drill</h3>
                <button class="drill-back-btn" onclick="exitDrill()">‚Üê Back</button>
            </div>
            <div id="drill-progress" class="drill-progress">Rep 1 of 10</div>
            <div id="drill-passage-display" class="drill-passage-display"></div>
            <textarea id="drill-input" class="drill-input" placeholder="Type the text above..." autocomplete="off"
                autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
            <div class="drill-accuracy-bar">
                <div id="drill-accuracy-fill" class="drill-accuracy-fill"></div>
            </div>
            <div class="drill-stats">
                <span>Accuracy: <strong id="drill-acc-text">100%</strong></span>
                <span>Errors: <strong id="drill-err-text">0</strong></span>
                <span id="drill-wpm-stat" class="drill-wpm-stat">WPM: <strong id="drill-wpm-text">0</strong></span>
            </div>
            <div id="drill-complete" class="drill-complete-card hidden">
                <h3>Drill Complete!</h3>
                <p id="drill-complete-msg"></p>
                <p id="drill-record-msg" class="drill-record-msg"></p>
                <div class="drill-complete-actions">
                    <button onclick="restartDrill()" class="drill-action-btn drill-repeat-btn">üîÑ Repeat</button>
                    <button id="drill-back-to-results-btn" onclick="backToResults()" class="drill-action-btn drill-results-btn">‚Üê Back to Results</button>
                    <button onclick="exitDrill()" class="drill-action-btn">‚Üê Back</button>
                </div>
            </div>
        </div>
    </main>

    <!-- RESULTS VIEW -->
    <div id="results-view" class="results-view results-wrapper">
        <div class="score-hero">
            <h2 id="results-title">Practice Complete!</h2>
            <div class="score-ring" id="score-ring">
                <span class="score-value" id="score-wpm">0</span>
            </div>
            <p class="score-label">Words Per Minute</p>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="stat-accuracy">0%</div>
                <div class="stat-label">Accuracy</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="stat-chars">0</div>
                <div class="stat-label">Characters</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="stat-correct">0</div>
                <div class="stat-label">Correct</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="stat-errors">0</div>
                <div class="stat-label">Errors</div>
            </div>
        </div>

        <!-- WPM Timeline Chart -->
        <div class="chart-section">
            <h3>WPM Over Time</h3>
            <canvas id="wpm-chart" width="800" height="200"></canvas>
        </div>

        <div class="action-buttons">
            <button class="btn-analyze" id="analyze-btn">Get AI Typing Coach</button>
            <button onclick="location.reload()">üîÑ Try Again</button>
            <button onclick="location.href='/dashboard.html'">Dashboard</button>
        </div>

        <!-- AI Coach Panel (visual cards) -->
        <div id="coach-panel" class="coach-panel">
            <div id="coach-content"></div>
        </div>
    </div>

    <script src="toast.js"></script>
    <script type="module" src="/js/pages/practice.js"></script>
    <script src="theme-toggle.js"></script>
</body>

</html>
