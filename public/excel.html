<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Excel Test</title>
    <link rel="stylesheet" href="style.css" />
    <script src="/auth.js" defer></script>
    <script src="/test-ui.js" defer></script>
    <script src="/disable-back.js" defer></script>
</head>
<body class="test-page excel-page">
    <header class="mobile-header">
        <span id="mobile-stage-title">Stage 3: Excel</span>
        <strong id="mobile-timer">5:00</strong>
    </header>
    <main class="test-container">
        <header class="test-header desktop-only">
            <hgroup>
                <h2 id="stage-title">Stage 3 of 3: Excel Test</h2>
            </hgroup>
            <div class="progress-container">
                <div id="progress-bar" class="progress-bar"></div>
            </div>
        </header>

        <article class="excel-content">
            <div class="instructions-card">
                <h3 id="question-name">Loading question...</h3>
                <p>1. Click the link below to download the Excel exercise file.</p>
                <p>2. Complete all tasks described in the file's "Instructions" sheet.</p>
                <p>3. Save your completed file and upload it below.</p>
                <a href="#" id="download-btn" role="button" class="contrast" download disabled>Download Question File</a>
            </div>

            <div class="upload-card">
                <h3>Upload Your Solution</h3>
                <form id="excel-form">
                    <input type="file" id="excel-file" name="excelFile" required>
                    <button type="submit" class="submit-btn-main">Submit Final Answers</button>
                </form>
            </div>
        </article>

        <footer class="test-footer">
            <div class="timer-display">
                <span>Time Left:</span>
                <strong id="timer">5:00</strong>
            </div>
        </footer>
    </main>

    <script src="excel.js"></script>
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="spinner"></div>
        <p>Calculating results, please wait...</p>
    </div>
</body>
</html>